#!/bin/sh
HEFQUIN_CP="$HEFQUIN_HOME"'/libs/hefquin-cli-0.0.4-SNAPSHOT.jar'
SCRIPT_DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" &> /dev/null && pwd )"
source ${SCRIPT_DIR}/common.sh

# Function to display help message
usage() {
    echo "Usage: hefquin-pgmat --lpg2rdfconf=<lpg2_rdf_config> \
                               --endpoint=<neo4j_uri_endpoint> \
                               --username=<neo4j_username> \
                               --password=<neo4j_password>"
    echo ""
    echo "Options:"
    echo "  -e, --endpoint              URI of Neo4j endpoint (required)"
    echo "  --lpg2rdfconf               File with an RDF description of the LPG-to-RDF configuration (optional)"
    echo "  --username                  Username of Neo4j endpoint"
    echo "  --password                  Password of Neo4j endpoint"
    echo "  -h, --help                  Show this help message"
    exit 1
}

# Parse command-line arguments
ARGS=()

while [ "$#" -gt 0 ]; do
    case "$1" in
        -e|--endpoint)
            ENDPOINT="$2"
            shift 2
            ;;
        --lpg2rdfconf)
            LPG2RDFCONF="$2"
            shift 2
            ;;
        --username)
            USERNAME="$2"
            shift 2
            ;;
        --password)
            PASSWORD="$2"
            shift 2
            ;;
        -h|--help)
            usage
            ;;
        *)
            echo "Unknown option: $1"
            usage
            ;;
    esac
done

# Add arguments
if [ -n "$ENDPOINT" ]; then
    ARGS+=("--endpoint" "$ENDPOINT")
fi
if [ -n "$LPG2RDFCONF" ]; then
    ARGS+=("--lpg2rdfconf" "$LPG2RDFCONF")
fi
if [ -n "$USERNAME" ]; then
    ARGS+=("--username" "$USERNAME")
fi
if [ -n "$PASSWORD" ]; then
    ARGS+=("--password" "$PASSWORD")
fi

# Run the Java command
"$JAVA" $JVM_ARGS -cp "$HEFQUIN_CP" se.liu.ida.hefquin.cli.MaterializeRDFViewOfLPG "${ARGS[@]}"